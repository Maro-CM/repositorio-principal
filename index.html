<!DOCTYPE html>
<html lang="es" class="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plan Final: Matemática Aplicada - Mauro Algañaraz</title>
    
    <!-- Tailwind CSS para estilos -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        dark: {
                            bg: '#0f172a', // slate-950
                            card: '#1e293b', // slate-800
                            border: '#334155', // slate-700
                            text: '#f1f5f9', // slate-100
                            muted: '#94a3b8' // slate-400
                        }
                    }
                }
            }
        }
    </script>
    
    <!-- Iconos Lucide -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Configuración de fuentes -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Outfit', sans-serif; }
        /* Animaciones suaves */
        .transition-all { transition-property: all; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 300ms; }
        
        /* Scrollbar personalizado */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        .dark ::-webkit-scrollbar-thumb { background: #475569; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 dark:bg-slate-950 dark:text-slate-100 transition-colors duration-300 flex flex-col min-h-screen selection:bg-indigo-500 selection:text-white">

    <!-- Navbar / Header Principal -->
    <div class="bg-white/80 dark:bg-slate-900/80 border-b border-slate-200 dark:border-slate-800 sticky top-0 z-10 backdrop-blur-md transition-colors duration-300">
        <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
            <div class="flex items-center gap-4">
                <div class="bg-indigo-600 dark:bg-indigo-500 p-2.5 rounded-xl text-white shadow-lg shadow-indigo-500/30">
                    <i data-lucide="graduation-cap" class="w-6 h-6"></i>
                </div>
                <div>
                    <h1 class="text-xl font-bold text-slate-900 dark:text-white leading-tight tracking-tight">Matemática Aplicada</h1>
                    <p class="text-xs text-slate-500 dark:text-slate-400 font-medium uppercase tracking-wider">Plan Final • 2025</p>
                </div>
            </div>
            
            <div class="flex items-center gap-6">
                <!-- Barra de progreso general -->
                <div class="hidden sm:flex flex-col items-end w-48">
                    <div class="text-xs font-bold text-indigo-600 dark:text-indigo-400 mb-1.5 flex justify-between w-full">
                        <span>Progreso Total</span>
                        <span id="total-progress-text">0%</span>
                    </div>
                    <div class="w-full h-2 bg-slate-200 dark:bg-slate-800 rounded-full overflow-hidden">
                        <div id="total-progress-bar" class="h-full bg-indigo-600 dark:bg-indigo-500 transition-all duration-700 ease-out shadow-[0_0_10px_rgba(99,102,241,0.5)]" style="width: 0%"></div>
                    </div>
                </div>

                <!-- Toggle Dark Mode (Accesible) -->
                <button onclick="toggleTheme()" aria-label="Alternar tema oscuro" title="Alternar tema oscuro" class="p-2 rounded-lg bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors">
                    <i data-lucide="moon" class="w-5 h-5 hidden dark:block"></i>
                    <i data-lucide="sun" class="w-5 h-5 block dark:hidden"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Contenido Principal -->
    <main class="flex-grow max-w-6xl mx-auto px-4 py-10 w-full">
        <div class="flex justify-between items-end mb-8">
            <div>
                <h2 class="text-3xl font-bold text-slate-800 dark:text-white mb-2">Tu Ruta de Estudio</h2>
                <p class="text-slate-500 dark:text-slate-400">Sigue el plan paso a paso para dominar el examen final.</p>
            </div>
            <button onclick="resetProgress()" class="text-xs font-medium text-slate-400 hover:text-red-500 dark:text-slate-500 dark:hover:text-red-400 transition-colors flex items-center gap-1">
                <i data-lucide="rotate-ccw" class="w-3 h-3"></i> Reiniciar
            </button>
        </div>

        <div id="days-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Las tarjetas se generarán aquí con JS -->
        </div>
    </main>

    <!-- Pie de Página (Footer) con tus datos -->
    <footer class="mt-auto border-t border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 py-8 transition-colors duration-300">
        <div class="max-w-6xl mx-auto px-4 flex flex-col md:flex-row justify-between items-center gap-4 text-center md:text-left">
            <div>
                <p class="text-lg font-bold text-slate-800 dark:text-slate-200">Mauro Algañaraz</p>
                <p class="text-sm text-slate-500 dark:text-slate-400">Tecnicatura Superior en Desarrollo de Software</p>
            </div>
            <div class="flex flex-col items-center md:items-end">
                <div class="flex items-center gap-2 text-sm font-medium text-indigo-600 dark:text-indigo-400 bg-indigo-50 dark:bg-indigo-900/30 px-3 py-1 rounded-full mb-1">
                    <i data-lucide="book-open" class="w-3 h-3"></i> Matemática Aplicada
                </div>
                <p class="text-xs text-slate-400 dark:text-slate-500 uppercase tracking-widest">Examen Final 2025</p>
            </div>
        </div>
    </footer>

    <!-- Modal de Detalle -->
    <div id="modal-overlay" class="hidden fixed inset-0 bg-slate-900/60 dark:bg-black/80 flex items-center justify-center p-4 z-50 backdrop-blur-sm transition-all duration-300">
        <div id="modal-content" class="bg-white dark:bg-slate-900 w-full max-w-2xl rounded-2xl shadow-2xl dark:shadow-slate-950/50 overflow-hidden flex flex-col max-h-[90vh] transform scale-95 opacity-0 transition-all duration-300 border border-slate-100 dark:border-slate-800">
            <!-- El contenido del modal se inyectará aquí -->
        </div>
    </div>

    <script>
        // ==========================================
        // CONFIGURACIÓN DE TEMA (Dark Mode)
        // ==========================================
        function loadTheme() {
            if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        }

        function toggleTheme() {
            if (document.documentElement.classList.contains('dark')) {
                document.documentElement.classList.remove('dark');
                localStorage.theme = 'light';
            } else {
                document.documentElement.classList.add('dark');
                localStorage.theme = 'dark';
            }
        }
        
        loadTheme();

        // ==========================================
        // DATOS INICIALES
        // ==========================================
        const defaultPlan = [
          {
            id: 1,
            day: "Día 1",
            title: "El Mundo de las Matrices",
            color: "from-blue-500 to-cyan-500",
            border: "border-blue-500",
            textAccent: "text-blue-500 dark:text-blue-400",
            bgAccent: "bg-blue-50 dark:bg-blue-900/20",
            topics: [
              { id: 't1-1', text: "Concepto, orden y tipos de matrices (Clase 1)", completed: false },
              { id: 't1-2', text: "Suma, Resta y Multiplicación (Condiciones)", completed: false },
              { id: 't1-3', text: "Propiedades básicas (Conmutativa, Asociativa)", completed: false },
              { id: 't1-4', text: "Matriz Transpuesta y sus propiedades", completed: false }
            ],
            activity: "Escribe 3 matrices de distintos tamaños. Suma y multiplica las que se puedan. Verifica la traspuesta.",
            notes: ""
          },
          {
            id: 2,
            day: "Día 2",
            title: "Determinantes e Inversas",
            color: "from-violet-500 to-purple-500",
            border: "border-violet-500",
            textAccent: "text-violet-500 dark:text-violet-400",
            bgAccent: "bg-violet-50 dark:bg-violet-900/20",
            topics: [
              { id: 't2-1', text: "Determinantes 2x2 y 3x3 (Sarrus)", completed: false },
              { id: 't2-2', text: "Determinantes 4x4 (Gauss)", completed: false },
              { id: 't2-3', text: "Definición de Matriz Inversible", completed: false },
              { id: 't2-4', text: "Cálculo de Inversa (Si Det != 0)", completed: false }
            ],
            activity: "Calcula el determinante de una matriz 3x3. Si no es 0, halla su inversa y verifica A * A^-1 = I.",
            notes: ""
          },
          {
            id: 3,
            day: "Día 3",
            title: "Vectores R2 y R3",
            color: "from-pink-500 to-rose-500",
            border: "border-pink-500",
            textAccent: "text-pink-500 dark:text-pink-400",
            bgAccent: "bg-pink-50 dark:bg-pink-900/20",
            topics: [
              { id: 't3-1', text: "Gráfica de vectores en R2 y R3", completed: false },
              { id: 't3-2', text: "Operaciones: Suma, Resta, Escalar", completed: false },
              { id: 't3-3', text: "Producto Punto y Ángulos", completed: false },
              { id: 't3-4', text: "Condición de Ortogonalidad", completed: false }
            ],
            activity: "Inventa dos vectores en R3. Calcula su suma, resta y el ángulo entre ellos.",
            notes: ""
          },
          {
            id: 4,
            day: "Día 4",
            title: "Sistemas de Ecuaciones",
            color: "from-orange-500 to-amber-500",
            border: "border-orange-500",
            textAccent: "text-orange-500 dark:text-orange-400",
            bgAccent: "bg-orange-50 dark:bg-orange-900/20",
            topics: [
              { id: 't4-1', text: "Clasificación (Compatible/Incompatible)", completed: false },
              { id: 't4-2', text: "Regla de Cramer (Determinantes)", completed: false },
              { id: 't4-3', text: "Método de Gauss (Filas)", completed: false },
              { id: 't4-4', text: "Resolución de problemas aplicados", completed: false }
            ],
            activity: "Resuelve el problema de los programadores (Clase 4) cambiando los costos horarios.",
            notes: ""
          },
          {
            id: 5,
            day: "Día 5",
            title: "Espacios Vectoriales",
            color: "from-emerald-500 to-teal-500",
            border: "border-emerald-500",
            textAccent: "text-emerald-500 dark:text-emerald-400",
            bgAccent: "bg-emerald-50 dark:bg-emerald-900/20",
            topics: [
              { id: 't5-1', text: "Subespacio Vectorial (3 condiciones)", completed: false },
              { id: 't5-2', text: "Concepto de Combinación Lineal", completed: false },
              { id: 't5-3', text: "Dependencia e Independencia Lineal", completed: false },
              { id: 't5-4', text: "Espacio Generado", completed: false }
            ],
            activity: "Demuestra si un conjunto dado es un subespacio vectorial verificando las 3 leyes.",
            notes: ""
          },
          {
            id: 6,
            day: "Día 6",
            title: "Base e Integración",
            color: "from-indigo-500 to-blue-600",
            border: "border-indigo-500",
            textAccent: "text-indigo-500 dark:text-indigo-400",
            bgAccent: "bg-indigo-50 dark:bg-indigo-900/20",
            topics: [
              { id: 't6-1', text: "Definición de Base (Generador + LI)", completed: false },
              { id: 't6-2', text: "Cálculo de Dimensión", completed: false },
              { id: 't6-3', text: "Repaso General de Unidades 1-6", completed: false },
              { id: 't6-4', text: "Simulacro de Examen", completed: false }
            ],
            activity: "Realizar un examen de práctica mezclando matrices, SEL y espacios vectoriales.",
            notes: ""
          }
        ];

        // ==========================================
        // LÓGICA DE LA APP
        // ==========================================
        let plan = [];
        let currentDayId = null;
        let isEditing = false;

        function loadData() {
            const saved = localStorage.getItem('studyTrackerData_Mauro_v3');
            if (saved) {
                plan = JSON.parse(saved);
            } else {
                plan = JSON.parse(JSON.stringify(defaultPlan));
            }
            renderApp();
        }

        // FIX: saveData con opción 'render' para no perder el foco al escribir
        function saveData(render = true) {
            localStorage.setItem('studyTrackerData_Mauro_v3', JSON.stringify(plan));
            if (render) {
                renderApp();
            }
        }

        function resetProgress() {
            if(confirm("¿Reiniciar todo el progreso? Esta acción es irreversible.")) {
                plan = JSON.parse(JSON.stringify(defaultPlan));
                saveData(true);
            }
        }

        // ==========================================
        // RENDERIZADO
        // ==========================================
        function renderApp() {
            renderHeaderStats();
            renderGrid();
            // Solo renderizar modal si está abierto y NO estamos en edición activa (para no perder foco)
            // En realidad, queremos renderizarlo solo si cambiamos de día o al inicio, 
            // pero no cuando escribimos notas.
            // La función updateNote llama a saveData(false), así que esto está cubierto.
            if (currentDayId !== null) {
                // Sin embargo, para el modal, si no volvemos a pintarlo al abrirlo, está vacío.
                // Aquí usamos un check simple: si el contenido ya está, no hacemos nada agresivo
                // a menos que sea la primera carga.
                // Para simplificar: renderModalContent se llama explícitamente al abrir el modal.
                // Aquí solo lo actualizamos si necesitamos refrescar checkboxes visualmente.
            }
            lucide.createIcons();
        }

        function renderHeaderStats() {
            const totalTopics = plan.reduce((acc, day) => acc + day.topics.length, 0);
            const completedTopics = plan.reduce((acc, day) => acc + day.topics.filter(t => t.completed).length, 0);
            const percent = totalTopics === 0 ? 0 : Math.round((completedTopics / totalTopics) * 100);

            const textEl = document.getElementById('total-progress-text');
            const barEl = document.getElementById('total-progress-bar');
            
            if(textEl) textEl.textContent = `${percent}%`;
            if(barEl) barEl.style.width = `${percent}%`;
        }

        function renderGrid() {
            const container = document.getElementById('days-grid');
            if(!container) return;
            container.innerHTML = '';

            plan.forEach(day => {
                const completedCount = day.topics.filter(t => t.completed).length;
                const totalCount = day.topics.length;
                const progress = totalCount === 0 ? 0 : (completedCount / totalCount) * 100;
                const isDone = progress === 100;

                const card = document.createElement('div');
                card.className = `
                    relative bg-white dark:bg-slate-800 rounded-2xl p-0
                    border border-slate-200 dark:border-slate-700 
                    hover:border-indigo-400 dark:hover:border-indigo-500 hover:shadow-xl dark:hover:shadow-slate-900/50 
                    hover:-translate-y-1 transition-all duration-300 cursor-pointer group overflow-hidden flex flex-col h-full
                `;
                card.onclick = () => openModal(day.id);

                card.innerHTML = `
                    <div class="h-1.5 w-full bg-gradient-to-r ${day.color}"></div>
                    <div class="p-6 flex-1 flex flex-col">
                        <div class="flex justify-between items-start mb-4">
                            <span class="px-2.5 py-1 rounded-md text-xs font-bold uppercase tracking-wide bg-slate-100 dark:bg-slate-700 text-slate-500 dark:text-slate-300 group-hover:bg-indigo-50 group-hover:text-indigo-600 dark:group-hover:bg-slate-700 dark:group-hover:text-indigo-400 transition-colors">
                                ${day.day}
                            </span>
                            ${isDone 
                                ? '<div class="bg-emerald-500/10 dark:bg-emerald-500/20 p-1 rounded-full"><i data-lucide="check" class="w-4 h-4 text-emerald-500 dark:text-emerald-400"></i></div>' 
                                : `<div class="text-slate-300 dark:text-slate-600"><i data-lucide="circle" class="w-5 h-5"></i></div>`
                            }
                        </div>
                        
                        <h3 class="text-xl font-bold text-slate-800 dark:text-white mb-2 group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition-colors">
                            ${day.title}
                        </h3>
                        
                        <p class="text-sm text-slate-500 dark:text-slate-400 mb-6 line-clamp-2 font-light">
                            ${day.activity}
                        </p>

                        <div class="mt-auto">
                            <div class="flex justify-between text-xs mb-2 font-medium text-slate-400 dark:text-slate-500">
                                <span>Avance</span>
                                <span class="${isDone ? 'text-emerald-500' : ''}">${Math.round(progress)}%</span>
                            </div>
                            <div class="w-full h-1.5 bg-slate-100 dark:bg-slate-700 rounded-full overflow-hidden">
                                <div class="h-full rounded-full transition-all duration-700 bg-gradient-to-r ${isDone ? 'from-emerald-400 to-emerald-500' : day.color}" style="width: ${progress}%"></div>
                            </div>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // ==========================================
        // MODAL LOGIC
        // ==========================================
        function openModal(dayId) {
            currentDayId = dayId;
            isEditing = false;
            const overlay = document.getElementById('modal-overlay');
            const content = document.getElementById('modal-content');
            
            overlay.classList.remove('hidden');
            setTimeout(() => {
                content.classList.remove('scale-95', 'opacity-0');
                content.classList.add('scale-100', 'opacity-100');
            }, 10);

            renderModalContent();
        }

        function closeModal() {
            renderApp(); // Refrescar grid al cerrar por si hubo cambios
            
            const overlay = document.getElementById('modal-overlay');
            const content = document.getElementById('modal-content');

            content.classList.remove('scale-100', 'opacity-100');
            content.classList.add('scale-95', 'opacity-0');
            
            setTimeout(() => {
                overlay.classList.add('hidden');
                currentDayId = null;
            }, 300);
        }

        document.getElementById('modal-overlay').addEventListener('click', function(e) {
            if (e.target === this) closeModal();
        });

        function toggleEditMode() {
            isEditing = !isEditing;
            renderModalContent();
        }

        // FIX: Funciones de actualización usan saveData(false)
        function updateDayTitle(val) { 
            plan.find(d => d.id === currentDayId).title = val; 
            saveData(false); 
        }
        function updateActivity(val) { 
            plan.find(d => d.id === currentDayId).activity = val; 
            saveData(false); 
        }
        function updateNote(val) { 
            plan.find(d => d.id === currentDayId).notes = val; 
            saveData(false); 
        }
        function updateTopicText(topicId, val) { 
            plan.find(d => d.id === currentDayId).topics.find(t => t.id === topicId).text = val; 
            saveData(false); 
        }
        
        function toggleTopic(topicId) {
            if (isEditing) return; 
            const day = plan.find(d => d.id === currentDayId);
            const topic = day.topics.find(t => t.id === topicId);
            if (topic) {
                topic.completed = !topic.completed;
                saveData(true); // Aquí SI refrescamos para ver el cambio visual del check
                renderModalContent(); // Refrescar modal para ver el check
            }
        }

        function renderModalContent() {
            if (currentDayId === null) return;
            const day = plan.find(d => d.id === currentDayId);
            const container = document.getElementById('modal-content');
            const completedCount = day.topics.filter(t => t.completed).length;

            // Utilizamos 'oninput' para los campos de texto para un guardado fluido sin perder foco.
            container.innerHTML = `
                <!-- Header Modal -->
                <div class="bg-gradient-to-r ${day.color} p-6 text-white flex justify-between items-start relative overflow-hidden">
                    <div class="absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]"></div>
                    
                    <div class="relative z-10 flex-1">
                        <h3 class="text-xs font-bold uppercase tracking-widest opacity-90 mb-1 text-white/80">${day.day}</h3>
                        ${isEditing 
                            ? `<input type="text" value="${day.title}" oninput="updateDayTitle(this.value)" class="text-2xl font-bold bg-white/20 border-b border-white/50 focus:outline-none w-full rounded px-2 py-1 text-white">` 
                            : `<h2 class="text-3xl font-bold tracking-tight">${day.title}</h2>`
                        }
                    </div>
                    <button onclick="closeModal()" aria-label="Cerrar detalles" title="Cerrar detalles" class="relative z-10 bg-white/20 hover:bg-white/30 p-2 rounded-full transition text-white backdrop-blur-sm">
                        <i data-lucide="x" class="w-5 h-5"></i>
                    </button>
                </div>

                <!-- Body Scrollable -->
                <div class="p-6 overflow-y-auto flex-1 space-y-8 custom-scroll bg-white dark:bg-slate-900">
                    
                    <!-- Metas -->
                    <div>
                        <div class="flex items-center justify-between mb-4 border-b border-slate-100 dark:border-slate-800 pb-2">
                            <h4 class="text-lg font-bold text-slate-800 dark:text-white flex items-center gap-2">
                                <i data-lucide="target" class="w-5 h-5 ${day.textAccent}"></i>
                                Objetivos Clave
                            </h4>
                            <div class="text-xs font-bold px-2 py-1 rounded bg-slate-100 dark:bg-slate-800 text-slate-500 dark:text-slate-400">
                                ${completedCount} / ${day.topics.length}
                            </div>
                        </div>
                        
                        <div class="space-y-3">
                            ${day.topics.map(topic => `
                                <div class="flex items-start gap-3 group p-2 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors cursor-pointer" onclick="toggleTopic('${topic.id}')">
                                    <div class="mt-0.5 flex-shrink-0 transition-transform duration-200 ${topic.completed ? 'scale-110' : 'scale-100'}">
                                        ${topic.completed 
                                            ? `<i data-lucide="check-circle-2" class="w-6 h-6 text-emerald-500 fill-emerald-500/20"></i>` 
                                            : `<i data-lucide="circle" class="w-6 h-6 text-slate-300 dark:text-slate-600 group-hover:text-indigo-400"></i>`
                                        }
                                    </div>
                                    ${isEditing 
                                        ? `<input type="text" value="${topic.text}" onclick="event.stopPropagation()" oninput="updateTopicText('${topic.id}', this.value)" class="flex-1 bg-transparent border-b border-slate-200 dark:border-slate-700 focus:border-indigo-500 focus:outline-none text-slate-700 dark:text-slate-200">` 
                                        : `<span class="flex-1 text-slate-700 dark:text-slate-300 leading-snug pt-0.5 transition-all ${topic.completed ? 'line-through opacity-50 text-slate-400' : ''}">${topic.text}</span>`
                                    }
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Actividad -->
                    <div class="${day.bgAccent} rounded-xl p-5 border ${isEditing ? 'border-dashed border-2 border-indigo-300' : 'border-transparent'}">
                        <h4 class="text-sm font-bold ${day.textAccent} uppercase tracking-wide mb-2 flex items-center gap-2">
                            <i data-lucide="zap" class="w-4 h-4"></i>
                            Misión Práctica
                        </h4>
                        ${isEditing 
                            ? `<textarea onclick="event.stopPropagation()" oninput="updateActivity(this.value)" class="w-full bg-white/50 dark:bg-slate-800/50 rounded p-2 text-slate-700 dark:text-slate-200 text-sm focus:outline-none resize-none" rows="3">${day.activity}</textarea>`
                            : `<p class="text-slate-700 dark:text-slate-300 text-sm leading-relaxed font-medium">${day.activity}</p>`
                        }
                    </div>

                    <!-- Notas -->
                    <div>
                        <h4 class="text-lg font-bold text-slate-800 dark:text-white mb-3 flex items-center gap-2">
                            <i data-lucide="sticky-note" class="w-5 h-5 text-amber-500"></i>
                            Notas Personales
                        </h4>
                        <textarea 
                            oninput="updateNote(this.value)" 
                            placeholder="Escribe aquí fórmulas, dudas o recordatorios..."
                            class="w-full h-32 p-4 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-slate-700 dark:text-slate-300 focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 focus:outline-none resize-none shadow-inner text-sm font-mono"
                        >${day.notes}</textarea>
                    </div>
                </div>

                <!-- Footer Controls -->
                <div class="p-4 border-t border-slate-100 dark:border-slate-800 flex justify-between items-center bg-slate-50/50 dark:bg-slate-900/50 backdrop-blur">
                     <button onclick="toggleEditMode()" class="flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition ${isEditing ? 'bg-indigo-600 text-white shadow-md shadow-indigo-500/30' : 'text-slate-600 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-800'}">
                        ${isEditing 
                            ? '<i data-lucide="save" class="w-4 h-4"></i> Guardar' 
                            : '<i data-lucide="edit-3" class="w-4 h-4"></i> Editar'
                        }
                     </button>
                     <button onclick="closeModal()" class="text-slate-500 dark:text-slate-400 text-sm font-medium hover:text-slate-800 dark:hover:text-white transition px-4">
                       Cerrar
                     </button>
                </div>
            `;
            
            lucide.createIcons();
        }

        window.onload = loadData;
    </script>
</body>
</html>
